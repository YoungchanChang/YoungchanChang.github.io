---
layout: post
title: 엘라스틱서치 documelnt Index
category: python
tags: [python, 쓰기]
comments: true
---

# 인덱싱하기

- Elasticserach에 데이터를 넣은 뒤면 데이터를 인덱싱 할 수 있다. JSON문서를 엘라스틱에서치 인덱스에 넣으면 된다.

### 인덱스란

- 책 속에 다루어진 중요한 단어나 용어를 독자가 쉽게 찾을 수 있도록 페이지를 밝혀 벌여 놓은 것. 책 뒷부분의 **찾아보기**가 있음

- 도큐먼트를 모아놓은 집합을 인덱스(Index)

- 배열에서 좌측 첫 번째 위치로부터 번호를 할당하는 것을 **인덱스(index)**라고 부른다. 인덱스를 사용하여 엘리먼트를 가리키는 것을 **인덱싱(indexing)**이라고 부른다.


### 데이터 넣기

- customer index를 만들고 id는 1인 document를 만든다. name field의 내용을 저장한다.

```
PUT /customer/_doc/1
{
  "name": "John Doe"
}
```

- 버전1의 문서가 **완성**되었다고 메시지가 온다. 

```
{
  "_index" : "customer",
  "_type" : "_doc",
  "_id" : "1",
  "_version" : 1,
  "result" : "created",
  "_shards" : {
    "total" : 2,
    "successful" : 2,
    "failed" : 0
  },
  "_seq_no" : 26,
  "_primary_term" : 4
}
```

- 만약에 똑같은 이름의 문서를 PUT으로 넣는다면 **업데이트**가 되었다고 뜬다. 이전 문서와 다른 respons는 version, result, _seq_no이 있다.

```
{
    "_index": "customer",
    "_type": "_doc",
    "_id": "1",
    "_version": 2,
    "result": "updated",
    "_shards": {
        "total": 2,
        "successful": 1,
        "failed": 0
    },
    "_seq_no": 1,
    "_primary_term": 2
}
```


- GET방식으로 가져올 수 있다.

```
GET /customer/_doc/1
```

```
{
  "_index" : "customer",
  "_type" : "_doc",
  "_id" : "1",
  "_version" : 1,
  "_seq_no" : 26,
  "_primary_term" : 4,
  "found" : true,
  "_source" : {
    "name": "John Doe"
  }
}
```


### 다량의 데이터 넣기

- 다량의 데이터는 accounts.json데이터를 넣을 수 있다.

```
curl -H "Content-Type: application/json" -XPOST "localhost:9200/bank/_bulk?pretty&refresh" --data-binary "@accounts.json"
curl "localhost:9200/_cat/indices?v"
```

- POSTMAN을 사용할 시에 BODY에서 binary로 체크한다.

<center>
<figure>
<img src="https://imgur.com/2Y0Lk0f.png" alt="views">
<figcaption>binary로 데이터를 넣을 수 있다.</figcaption>
</figure>
</center>


- 성공시 데이터가 어떻게 저장되었는지 확인할 수 있다.

<center>
<figure>
<img src="https://imgur.com/pjFyEHW.png" alt="views">
<figcaption>정상 동작되는지 확인</figcaption>
</figure>
</center>

### 추가로 알아두면 좋은 사항 - RDBMS비교

인덱스와  |  RDBMS

인덱스(Index) | 데이터베이스(Database)
샤드(Shard) | 파티션(Partition)
타입(Type) | 테이블(Table)
문서(Document) | 행(Row)
필드(Field) | 열(Column)
매핑(Mapping) | 스키마(Schema)
Query DSL | SQL

# 참고문서

[엘라스틱 서치](https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started-index.html)

[엘라스틱 서치 특징](https://www.samsungsds.com/global/ko/support/insights/elasticsearch.html)

[RDBMS 비교](https://velog.io/@jakeseo_me/%EC%97%98%EB%9D%BC%EC%8A%A4%ED%8B%B1%EC%84%9C%EC%B9%98-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0-2-DB%EB%A7%8C-%EC%9E%88%EC%9C%BC%EB%A9%B4-%EB%90%98%EB%8A%94%EB%8D%B0-%EC%99%9C-%EA%B5%B3%EC%9D%B4-%EA%B2%80%EC%83%89%EC%97%94%EC%A7%84)

[DBMS 파티셔닝이란](https://gmlwjd9405.github.io/2018/09/24/db-partitioning.html)