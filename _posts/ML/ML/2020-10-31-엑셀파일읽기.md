---
layout: post
title: 엑셀 파일 읽기
category: ML
tags: [ML]
comments: ML
---

# 엑셀파일읽기


```python
bokji_excel = pd.read_excel(bv.DATASET_PATH, sheet_name=bv.sheet_info_original)
bokji_excel = bokji_excel[['index', '대분류', '소분류', '담당부서(기관)', '사업명', '사업내용', '지원대상', '지원내용', '발화 내용']]
# 이 행은 필수이다. 원본 복지 데이터의 index가 다른 문서들의 index의 기준이 될 수 있기 때문이다.
bokji_excel.index = bokji_excel['index']
bokji_dict = []
```

# 엑셀 파일 쓰기

- 2차원 행렬로 만든다.

```python
[['a', 'b', 'c',],
 ['d', 'e', 'f'],
 ['g', 'h', 'k']]]
```

- 2차원행렬을 dataframe에다가 넣는다. 그리고 컬럼명을 적는다.

```python
    bokji_dict.append([i, str(list(set(word_collection)))])
    df = pd.DataFrame({"word_tag": word_tag, "word_len": word_len, "word_count": word_count})
    df = pd.DataFrame(bokji_dict, columns=['index', '추출 단어'])

def write_excel_sheet(df, sheet_name, DATASET_PATH):
    """
    엑셀시트에 추가하는 기능
    """

    writer = pd.ExcelWriter(DATASET_PATH, engine='openpyxl')
    writer.book = load_workbook(DATASET_PATH)

    df.to_excel(writer, sheet_name=sheet_name, index=False)
    writer.save()
    writer.close()
```